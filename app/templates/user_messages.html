{% extends "base.html" %}

{% block title %}PÅ™Ã­spÄ›vky od {{ user.name }}{% endblock %}

{# Definice maker - musÃ­ bÃ½t nahoÅ™e #}
{% macro message_card(msg) %}
<div class="message-card">
    <div class="message-header">
        <span class="message-date"
            title="{{ msg.created_at.strftime('%d.%m.%Y %H:%M:%S') }}">
            {{ msg.created_at.strftime('%d.%m.%Y %H:%M') }}
        </span>
        <form method="POST"
            action="{{ url_for('main.delete_message', message_id=msg.id) }}"
            style="display:inline;"
            onsubmit="return confirm('Opravdu chcete smazat tento pÅ™Ã­spÄ›vek?');">
            <button type="submit" class="btn-delete">ğŸ—‘ï¸ Smazat</button>
        </form>
    </div>
    <p class="message-text">{{ msg.message }}</p>
</div>
{% endmacro %}

{% block content %}
<div class="user-header">
    <h1>PÅ™Ã­spÄ›vky od {{ user.name }}</h1>
    <p class="user-email">{{ user.email }}</p>
    <p class="user-joined">ÄŒlen od: {{ user.created_at.strftime('%d.%m.%Y')
        }}</p>
    <a href="{{ url_for('main.index') }}" class="btn btn-secondary">â† ZpÄ›t na
        seznam</a>
</div>

{% if messages.items %}
<div class="messages-section">
    <h2>VÅ¡echny pÅ™Ã­spÄ›vky ({{ messages.total }})</h2>

    {% for msg in messages.items %}
    {{ message_card(msg) }}
    {% endfor %}

    <!-- Pagination -->
    {% if messages.pages > 1 %}
    <div class="pagination">
        {% if messages.has_prev %}
        <a
            href="{{ url_for('main.user_messages', user_id=user.id, page=messages.prev_num) }}"
            class="btn btn-small">â† PÅ™edchozÃ­</a>
        {% endif %}

        <span class="pagination-info">Strana {{ messages.page }} z {{
            messages.pages }}</span>

        {% if messages.has_next %}
        <a
            href="{{ url_for('main.user_messages', user_id=user.id, page=messages.next_num) }}"
            class="btn btn-small">DalÅ¡Ã­ â†’</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% else %}
<div class="no-messages">
    <p>Tento uÅ¾ivatel zatÃ­m nenapsal Å¾Ã¡dnÃ½ pÅ™Ã­spÄ›vek.</p>
</div>
{% endif %}

{% endblock %}
