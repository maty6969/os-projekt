{% extends "base.html" %}

{% block title %}Kniha nÃ¡vÅ¡tÄ›v - DomÅ¯{% endblock %}

{% block content %}
<div class="hero">
    <h1>VÃ­tejte v knize nÃ¡vÅ¡tÄ›v</h1>
    <p>PodÃ­vejte se, co napsali naÅ¡i nÃ¡vÅ¡tÄ›vnÃ­ci</p>
    <a href="{{ url_for('main.add_message') }}" class="btn btn-primary">PÅ™idat svou zprÃ¡vu</a>
</div>

{% if messages.items %}
    <div class="messages-section">
        <h2>PoslednÃ­ zprÃ¡vy ({{ messages.total }})</h2>
        
        {% for msg in messages.items %}
            {{ message_card(msg) }}
        {% endfor %}

        <!-- Pagination -->
        {% if messages.pages > 1 %}
            <div class="pagination">
                {% if messages.has_prev %}
                    <a href="{{ url_for('main.index', page=messages.prev_num) }}" class="btn btn-small">â† PÅ™edchozÃ­</a>
                {% endif %}
                
                <span class="pagination-info">Strana {{ messages.page }} z {{ messages.pages }}</span>
                
                {% if messages.has_next %}
                    <a href="{{ url_for('main.index', page=messages.next_num) }}" class="btn btn-small">DalÅ¡Ã­ â†’</a>
                {% endif %}
            </div>
        {% endif %}
    </div>
{% else %}
    <div class="no-messages">
        <p>ZatÃ­m zde nejsou Å¾Ã¡dnÃ© zprÃ¡vy.</p>
        <a href="{{ url_for('main.add_message') }}" class="btn btn-primary">BuÄte prvnÃ­, kdo napÃ­Å¡e zprÃ¡vu!</a>
    </div>
{% endif %}

{% macro message_card(msg) %}
    <div class="message-card">
        <div class="message-header">
            <h3 class="message-author">
                <a href="{{ url_for('main.user_messages', user_id=msg.user_id) }}">
                    ğŸ‘¤ {{ msg.user.name }}
                </a>
            </h3>
            <span class="message-date" title="{{ msg.created_at.strftime('%d.%m.%Y %H:%M:%S') }}">
                {{ msg.created_at.strftime('%d.%m.%Y %H:%M') }}
            </span>
        </div>
        <p class="message-email">{{ msg.user.email }}</p>
        <p class="message-text">{{ msg.message }}</p>
    </div>
{% endmacro %}
