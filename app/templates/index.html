{% extends "base.html" %}

{% block title %}Diskuze - VÅ¡echny pÅ™Ã­spÄ›vky{% endblock %}

{# Definice maker - musÃ­ bÃ½t nahoÅ™e #}
{% macro message_card(msg) %}
<div class="message-card">
    <div class="message-header">
        <div class="message-left">
            <h3 class="message-author">
                <a
                    href="{{ url_for('main.user_messages', user_id=msg.user_id) }}">
                    ğŸ‘¤ {{ msg.user.name }}
                </a>
            </h3>
            <span class="message-date"
                title="{{ msg.created_at.strftime('%d.%m.%Y %H:%M:%S') }}">
                {{ msg.created_at.strftime('%d.%m.%Y %H:%M') }}
            </span>
        </div>
        <form method="POST"
            action="{{ url_for('main.delete_message', message_id=msg.id) }}"
            style="display:inline;"
            onsubmit="return confirm('Opravdu chcete smazat tento pÅ™Ã­spÄ›vek?');">
            <button type="submit" class="btn-delete">ğŸ—‘ï¸ Smazat</button>
        </form>
    </div>
    <p class="message-email">{{ msg.user.email }}</p>
    <p class="message-text">{{ msg.message }}</p>
</div>
{% endmacro %}

{% block content %}
<div class="hero">
    <h1>VÃ­tejte v diskuzÃ­ch</h1>
    <p>PodÃ­vejte se na pÅ™Ã­spÄ›vky ostatnÃ­ch uÅ¾ivatelÅ¯</p>
    <a href="{{ url_for('main.add_message') }}" class="btn btn-primary">PÅ™idat
        pÅ™Ã­spÄ›vek</a>
</div>

{% if messages.items %}
<div class="messages-section">
    <h2>PoslednÃ­ pÅ™Ã­spÄ›vky ({{ messages.total }})</h2>

    {% for msg in messages.items %}
    {{ message_card(msg) }}
    {% endfor %}

    <!-- Pagination -->
    {% if messages.pages > 1 %}
    <div class="pagination">
        {% if messages.has_prev %}
        <a href="{{ url_for('main.index', page=messages.prev_num) }}"
            class="btn btn-small">â† PÅ™edchozÃ­</a>
        {% endif %}

        <span class="pagination-info">Strana {{ messages.page }} z {{
            messages.pages }}</span>

        {% if messages.has_next %}
        <a href="{{ url_for('main.index', page=messages.next_num) }}"
            class="btn btn-small">DalÅ¡Ã­ â†’</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% else %}
<div class="no-messages">
    <p>ZatÃ­m zde nejsou Å¾Ã¡dnÃ© pÅ™Ã­spÄ›vky.</p>
    <a href="{{ url_for('main.add_message') }}" class="btn btn-primary">BuÄte
        prvnÃ­, kdo napÃ­Å¡e pÅ™Ã­spÄ›vek!</a>
</div>
{% endif %}

{% endblock %}
